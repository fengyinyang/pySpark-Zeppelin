{"paragraphs":[{"text":"%pyspark\nimport numpy as np\nimport pandas as pd\n\n# reading json data from the API endpoint\nraw_data = pd.read_json('https://data.cityofnewyork.us/resource/h9gi-nx95.json')\n\n#data = raw_data[['date', 'time', 'latitude', 'longitude']].dropna()\ndata = raw_data[['latitude', 'longitude']].dropna()\n\ndata.to_csv('nypd_accidents.csv', header=None, index=None, sep=' ')\n\ndata = sc.textFile('nypd_accidents.csv')\nparsedData = data.map(lambda line: array([float(x) for x in line.strip().split(' ')]))","dateUpdated":"Feb 13, 2016 6:31:34 PM","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455396541672_743004669","id":"20160213-144901_1564137741","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Feb 13, 2016 2:49:01 PM","dateStarted":"Feb 13, 2016 6:31:35 PM","dateFinished":"Feb 13, 2016 6:31:38 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:605"},{"text":"%pyspark\n## Gaussian Mixture clustering\nfrom pyspark.mllib.clustering import GaussianMixture\nfrom numpy import array\n\n# Build the model (cluster the data)\ngmm = GaussianMixture.train(parsedData, 2)\n\n# output parameters of model\nfor i in range(2):\n    print (\"weight = \", gmm.weights[i], \"mu = \", gmm.gaussians[i].mu, \"sigma = \", gmm.gaussians[i].sigma.toArray())","dateUpdated":"Feb 13, 2016 6:32:10 PM","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455396541673_742619920","id":"20160213-144901_1115690060","result":{"code":"SUCCESS","type":"TEXT","msg":"('weight = ', 0.60130306322637828, 'mu = ', DenseVector([40.68, -73.9075]), 'sigma = ', array([[ 0.00330939,  0.00372963],\n       [ 0.00372963,  0.0112602 ]]))\n('weight = ', 0.39869693677362184, 'mu = ', DenseVector([40.7838, -73.9467]), 'sigma = ', array([[ 0.00287308,  0.00214218],\n       [ 0.00214218,  0.00225784]]))\n"},"dateCreated":"Feb 13, 2016 2:49:01 PM","dateStarted":"Feb 13, 2016 6:32:10 PM","dateFinished":"Feb 13, 2016 6:32:18 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:606"},{"text":"%pyspark\n## k-means clustering with k=6\nfrom pyspark.mllib.clustering import KMeans\n\nkmodel = KMeans.train(parsedData, 6)\nprint(\"Final centers: \" + str(kmodel.clusterCenters))\nprint(\"Total Cost: \" + str(kmodel.computeCost(parsedData)))","dateUpdated":"Feb 13, 2016 6:32:27 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455396541673_742619920","id":"20160213-144901_1723116463","result":{"code":"SUCCESS","type":"TEXT","msg":"Final centers: [array([ 40.74604647, -73.97304263]), array([ 40.59441898, -74.12354689]), array([ 40.84109278, -73.89492451]), array([ 40.71218458, -73.78048791]), array([ 40.70139499, -73.89473392]), array([ 40.63443527, -73.97367728])]\nTotal Cost: 1.78402702043\n"},"dateCreated":"Feb 13, 2016 2:49:01 PM","dateStarted":"Feb 13, 2016 6:32:27 PM","dateFinished":"Feb 13, 2016 6:32:29 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:607"},{"dateUpdated":"Feb 13, 2016 6:31:35 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1455400989675_-1025742986","id":"20160213-160309_1771040943","result":{"code":"SUCCESS","type":"TEXT"},"dateCreated":"Feb 13, 2016 4:03:09 PM","dateStarted":"Feb 13, 2016 6:31:36 PM","dateFinished":"Feb 13, 2016 6:31:36 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:608"}],"name":"MLlib_fun","id":"2BANKRUWS","angularObjects":{"2BCFJMDKK":[],"2BDS4QD2N":[],"2BANE2ZZJ":[],"2BBTRQU62":[],"2BB79Q58G":[],"2BAJ9HSGF":[],"2BE8VSB6H":[],"2BD9EQUSM":[],"2BDCUE528":[],"2BBSMES14":[],"2BCN9XJ4P":[],"2BCT5B8KA":[],"2BBUUR2BV":[],"2BD9UFHB9":[]},"config":{"looknfeel":"default"},"info":{}}